export const metadata = {
  title: '[Platinum V] 구간 합 구하기 3 - 11658',
  date: '2025-09-02 08:31:34',
  tags: ['자료 구조', '세그먼트 트리', '누적 합', '다차원 세그먼트 트리'],
  description: '[Platinum V] 구간 합 구하기 3 - 11658',
};

# [Platinum V] 구간 합 구하기 3 - 11658 

[문제 링크](https://www.acmicpc.net/problem/11658) 

### 성능 요약

메모리: 131948 KB, 시간: 664 ms

### 분류

자료 구조, 세그먼트 트리, 누적 합, 다차원 세그먼트 트리

### 제출 일자

2025년 9월 2일 17:30:46

### 문제 설명

N×N개의 수가 N×N 크기의 표에 채워져 있다. 그런데 중간에 수의 변경이 빈번히 일어나고 그 중간에 어떤 부분의 합을 구하려 한다. 표의 i행 j열은 (i, j)로 나타낸다. (x1, y1)부터 (x2, y2)까지 합이란 x1 ≤ x ≤ x2, y1 ≤ y ≤ y2를 만족하는 모든 (x, y)에 있는 수의 합이다.

예를 들어, N = 4이고, 표가 아래와 같이 채워져 있는 경우를 살펴보자.

	
		
			1
			2
			3
			4
		
		
			2
			3
			4
			5
		
		
			3
			4
			5
			6
		
		
			4
			5
			6
			7
		
	

여기서 (2, 2)부터 (3, 4)까지 합을 구하면 3+4+5+4+5+6 = 27이 된다. (2, 3)을 7로 바꾸고 (2, 2)부터 (3, 4)까지 합을 구하면 3+7+5+4+5+6=30 이 된다.

표에 채워져 있는 수와 변경하는 연산과 합을 구하는 연산이 주어졌을 때, 이를 처리하는 프로그램을 작성하시오.

### 입력 

 첫째 줄에 표의 크기 N과 수행해야 하는 연산의 수 M이 주어진다. (1 ≤ N ≤ 1024, 1 ≤ M ≤ 100,000) 둘째 줄부터 N개의 줄에는 표에 채워져있는 수가 1행부터 차례대로 주어진다. 다음 M개의 줄에는 네 개의 정수 w, x, y, c 또는 다섯 개의 정수 w, x1, y1, x2, y2가 주어진다. w = 0인 경우는 (x, y)를 c (1 ≤ c ≤ 1,000)로 바꾸는 연산이고, w = 1인 경우는 (x1, y1)부터 (x2, y2)의 합을 구해 출력하는 연산이다. (1 ≤ x1 ≤ x2 ≤ N, 1 ≤ y1 ≤ y2 ≤ N) 표에 채워져 있는 수는 1,000보다 작거나 같은 자연수이다.

### 출력 

 w = 1인 입력마다 구한 합을 순서대로 한 줄에 하나씩 출력한다.

### 풀이
```python
import sys
input = sys.stdin.readline

N, M = map(int, input().split())
board = [list(map(int, input().split())) for _ in range(N)]

tree = [[0]*(N+1) for _ in range(N+1)]

def update(r, c, value):
    x = r
    while x  0:
        y = c
        while y > 0:
            res += tree[x][y]
            y -= y&-y
        x -= x&-x
    return res

def range_sum(r1, c1, r2, c2):
    return query(r2, c2) - query(r2, c1-1) - query(r1-1, c2) + query(r1-1, c1-1)

for i in range(N):
    for j in range(N):
        update(i+1, j+1, board[i][j])

for _ in range(M):
    cmd = list(map(int, input().split()))
    if cmd[0] == 0:
        _, r, c, value = cmd
        diff = value - board[r-1][c-1]
        board[r-1][c-1] = value
        update(r, c, diff)
    else:
        _, r1, c1, r2, c2 = cmd
        print(range_sum(r1, c1, r2, c2))
'''
2차원 세그먼트 트리 : 세그먼트 트리 각 노드에 새로운 세그먼트 트리가 있는 구조

'''
```